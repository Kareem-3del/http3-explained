# HTTP/3 Server push

HTTP/3 server push شبيه باللي مشروح في HTTP/2 ([RFC 7540](https://httpwg.org/specs/rfc7540.html))، بس بيستخدم آليات مختلفة.

server push فعلياً هو رد على request إن الclient مابعتوش أبداً!

Server pushes مسموح بس لو الclient وافق عليها. في HTTP/3 الclient حتى بيحط حد لكام push يقبل عن طريق إنه يعلم السيرفر إيه أقصى push stream ID. تخطي الحد ده هيسبب connection error.

لو السيرفر اعتبر إنه على الأرجح الclient عايز resource إضافي ماطلبوش بس المفروض يكون عنده، يقدر يبعت `PUSH_PROMISE` frame (على request stream) يوري الrequest إيه شكله إن الpush ده رد عليه، وبعدين يبعت الرد الحقيقي على stream جديد.

حتى لما pushes اتقالت إنها مقبولة من الclient من قبل، كل pushed stream منفرد لسه ممكن يتلغي في أي وقت لو الclient شاف ده مناسب. ساعتها يبعت `CANCEL_PUSH` frame للسيرفر.

## مشكوك فيه

من لما الميزة دي اتناقشت أول مرة في تطوير HTTP/2 وبعدين لما البروتوكول اتشحن واتنشر على الإنترنت، الميزة دي اتناقشت واتكرهت واتخبطت بطرق كتيرة مختلفة عشان تبقى مفيدة.

الpushing مش أبداً "مجاني"، لأنه رغم إنه بيوفر نص round-trip لسه بيستخدم bandwidth. صعب أو مستحيل للserver-side إنه فعلاً يعرف بمستوى عالي من اليقين لو resource لازم يتpush ولا لأ.

مثال مصري: فكر في server push زي النادل في المطعم اللي يقولك "هجيبلك سلطة مع الأكل" قبل ما تطلبها. ممكن تعجبك (توفر وقت) أو ممكن متعجبكش (مش عايزها وهتدفع فيها). صعب النادل يخمن صح كل مرة.